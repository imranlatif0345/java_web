def tomcatServerUrl = "http://0.0.0.0:9020"
pipeline {
  agent any
    tools {
        // Install the Maven version configured as "M3" and add it to the path.
        maven "local_maven"
    }
  stages {
    //Use this code for inline pipeline script option
   stage('Git Checkout') {
            steps {
                script {
                    git branch: 'master',
                        credentialsId: 'git_credentials',
                        url: 'https://github.com/imranlatif0345/java_web.git'
                }
            }
        }
    stage('Build') {
      steps {
        git 'https://github.com/imranlatif0345/java_web.git'
        // Run the maven build
        sh '"mvn" -Dmaven.test.failure.ignore clean install'
      }

    }
    stage('Deploy') {
      steps {
        //deploy war on tomcat server
          deploy adapters: [tomcat(url: "${tomcatServerUrl}",
          credentialsId: 'tomcat-credentials')],
          war: 'target/*.war',
          contextPath: 'pipeline-app'
      }
    }
  }
}
